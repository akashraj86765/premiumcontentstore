<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Premium Private Content Store</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Your existing CSS remains unchanged */
    :root { --bg-color: #1e1e2f; --card-color: #2c2c3e; --text-color: #fff; --accent-color: linear-gradient(90deg, red, orange, #ff9900, teal); }
    [data-theme="light"] { --bg-color: #f5f5f5; --card-color: #ffffff; --text-color: #333; }
    body { margin: 0; font-family: 'Poppins', sans-serif; background-color: var(--bg-color); color: var(--text-color); min-height: 100vh; padding: 20px; transition: all 0.3s ease; }
    /* ... (keep all your existing styles) ... */
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">☀️</button>
  <header>
    <h1 class="header-title">Premium Private Content Store</h1>
    <p>Exclusive content available for limited time only</p>
  </header>
  <div class="products-grid" id="productsContainer"></div>
  <div class="overlay" id="overlay" onclick="closePopup()"></div>
  <div class="popup" id="popup">
    <img src="" alt="QR Code" id="popupQrCode">
    <div class="rainbow-price" id="popupPrice"></div>
    <p>Scan and pay using the above QR code. After payment, enter your Telegram ID/Number and upload payment screenshot.</p>
    <form id="popupForm" onsubmit="submitForm(event)">
      <input type="text" name="telegramId" placeholder="Enter Telegram ID/Number" required />
      <input type="file" name="paymentScreenshot" accept="image/*" required />
      <p class="qr-tooltip">Upload payment screenshot after payment</p>
      <button type="submit" class="confirm-btn">
        <span class="btn-text">Submit Payment Proof</span>
        <div class="loader"></div>
      </button>
    </form>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = 'https://sjogcspgoyhybaiooqfm.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNqb2djc3Bnb3loeWJhaW9vcWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2NjQwNDUsImV4cCI6MjA2NzI0MDA0NX0.2WLksrdiolPDv2uGNQAAmtdQWL0X0EYswM08KFWnKns';
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // Theme toggle
    function toggleTheme() {
      document.body.setAttribute('data-theme', document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light');
    }

    // Load products
    async function loadProducts() {
      try {
        const { data } = await supabase.from('products').select('*').order('created_at', { ascending: false });
        renderProducts(data || getHardcodedProducts());
      } catch (error) {
        console.error("Error:", error);
        renderProducts(getHardcodedProducts());
      }
    }

    // Fallback products (your current items)
    function getHardcodedProducts() {
      return [
        {
          id: '1', title: 'Private Recordings', 
          image: 'https://ik.imagekit.io/acsayebnbb/photo_2025-07-03_23-07-13.jpg',
          description: 'Girls Private Group Chat Full Recordings',
          original_price: '₹499', discounted_price: '₹99/- ONLY',
          button_text: '₹99/- BUY NOW', buyers_count: '1509+ Buyers',
          qr_code: 'https://ik.imagekit.io/acsayebnbb/photo_2025-06-14_20-53-32.jpg'
        },
        // Add all other products here...
      ];
    }

    // Render products
    function renderProducts(products) {
      const container = document.getElementById('productsContainer');
      container.innerHTML = products.map(product => `
        <div class="product-card">
          <div class="rainbow-text">${product.title}</div>
          <div class="preview">
            <img src="${product.image}" alt="${product.title}" onerror="this.src='https://via.placeholder.com/300x200?text=Product+Image'"/>
            <div class="image-caption">${product.description}</div>
          </div>
          <div class="price-info">
            <span class="original-price">${product.original_price}</span>
            <span class="discounted-price">${product.discounted_price}</span>
          </div>
          <div class="buyers-count">${product.buyers_count}</div>
          <div class="countdown">⏳ Offer ends in: <span class="timer">05:00</span></div>
          <button class="price-button" onclick="showPopup('${product.qr_code}', '${product.discounted_price}', '${product.id}')">
            ${product.button_text}
          </button>
        </div>
      `).join('');

      // Initialize countdown timers
      document.querySelectorAll('.timer').forEach(timer => {
        let timeLeft = 300;
        setInterval(() => {
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          if (timeLeft > 0) timeLeft--;
        }, 1000);
      });
    }

    // Popup functions
    function showPopup(qrSrc, priceText, productId) {
      document.getElementById("popupQrCode").src = qrSrc;
      document.getElementById("popupPrice").textContent = priceText;
      document.getElementById("popupForm").dataset.productId = productId;
      document.getElementById("popup").style.display = "flex";
      document.getElementById("overlay").style.display = "block";
    }

    function closePopup() {
      document.getElementById("popup").style.display = "none";
      document.getElementById("overlay").style.display = "none";
    }

    async function submitForm(event) {
      event.preventDefault();
      const form = event.target;
      const telegramId = form.querySelector('input[name="telegramId"]').value.trim();
      const fileInput = form.querySelector('input[type="file"]');
      
      if (!telegramId || fileInput.files.length === 0) {
        alert("Please fill all fields!");
        return;
      }

      const botToken = "7765536352:AAHc5Acqa2OMVUZ5u8BeLoAX8NCojg-zXhk";
      const chatId = "7586205549";
      const formData = new FormData();
      formData.append('chat_id', chatId);
      formData.append('caption', `New Payment\nProduct: ${form.dataset.productId}\nTelegram: ${telegramId}`);
      formData.append('photo', fileInput.files[0]);

      try {
        const response = await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
          method: "POST", body: formData
        });
        if ((await response.json()).ok) window.location.href = "https://t.me/ownerayush";
      } catch (error) {
        alert("Error: " + error.message);
      }
    }

    document.addEventListener('DOMContentLoaded', loadProducts);
  </script>
</body>
</html>